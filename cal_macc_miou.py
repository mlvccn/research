FRRN_3c = '80.0 & 71.2 & 53.0 & 46.1 & 65.1 & 53.0 & 34.0 & 27.1 & 21.6 & 19.1 & 0.0 & 0.0 & 34.7 & 32.5 & 36.2 & 30.5 & 47.1 & 41.8'
FRRN_4c = '81.9 & 74.7 & 66.2 & 60.8 & 62.8 & 50.3 & 41.2 & 35.0 & 12.5 & 11.5 & 0.0 & 0.0 & 37.2 & 34.0 & 35.2 & 34.6 & 48.5 & 44.2'
PSPNet_3c = '82.3 & 69.0 & 48.6 & 39.9 & 55.3 & 46.7 & 33.4 & 26.9 & 11.7 & 11.1 & 0.0 & 0.0 & 38.4 & 34.1 & 35.6 & 26.7 & 44.9 & 39.0'
PSPNet_4c = '81.0 & 74.8 & 69.2 & 61.3 & 63.8 & 50.2 & 44.7 & 38.4 & 18.1 & 15.8 & 0.0 & 0.0 & 36.4 & 33.2 & 49.0 & 44.4 & 51.3 & 46.1'
BiseNetV1_3c = '90.0 & 84.5 & 65.0 & 54.3 & 75.0 & 61.4 & 32.1 & 25.7 & 32.3 & 26.2 & 3.2 & 0.9 & 49.6 & 43.3 & 48.1 & 40.5 & 54.9 & 48.2'
BiseNetV1_4c = '89.7 & 84.1 & 72.0 & 63.2 & 74.1 & 60.1 & 45.1 & 36.7 & 34.2 & 25.3 & 18.2 & 5.0 & 47.4 & 42.2 & 39.8 & 35.9 & 57.7 & 50.0'
DFN_3c = '90.7 & 81.4 & 67.7 & 52.8 & 71.5 & 57.5 & 49.2 & 34.9 & 35.1 & 23.8 & 4.1 & 0.9 & 44.2 & 31.0 & 54.6 & 47.5 & 57.3 & 47.5'
DFN_4c = '90.0 & 84.4 & 73.2 & 65.0 & 75.5 & 60.9 & 54.0 & 40.4 & 38.9 & 25.7 & 10.2 & 4.0 & 48.3 & 42.5 & 55.8 & 47.4 & 60.5 & 52.0'
HRNet_3c = '92.2 & 86.6 & 73.1 & 59.8 & 74.9 & 61.3 & 47.0 & 33.2 & 38.3 & 28.7 & 7.3 & 1.4 & 54.6 & 47.2 & 61.5 & 46.2 & 60.9 & 51.3'
HRNet_4c = '92.8 & 87.6 & 79.3 & 71.0 & 78.3 & 63.4 & 59.8 & 42.5 & 25.7 & 19.1 & 18.8 & 2.7 & 56.5 & 49.8 & 63.5 & 44.5 & 63.7 & 53.2'
BiseNetV2_3c = ''
BiseNetV2_4c = ''

MFNet =  '77.2 & 65.9 & 67.0 & 58.9 & 53.9 & 42.9 & 36.2 & 29.9 & 12.5 & 9.9 & 0.1 & 0.0 & 30.3 & 25.2 & 30.0 & 27.7 & 45.1 & 39.7'
RTFNet = '93.0 & 87.4 & 79.3 & 70.3 & 76.8 & 62.7 & 60.7 & 45.3 & 38.5 & 29.8 & 0.0 & 0.0 & 45.5 & 29.1 & 74.7 & 55.7 & 63.1 & 53.2'
FuseSeg = '93.1 & 87.9 & 81.4 & 71.7 & 78.5 & 64.6 & 68.4 & 44.8 & 29.1 & 22.7 & 63.7 & 6.4 & 55.8 & 46.9 & 66.4 & 47.9 & 70.6 & 54.5'
# SGCFNet50_18 = '95.3 & 83.5 & 85.3 & 69.2 & 81.3 & 58.5 & 73.9 & 37.7 & 47.5 & 32.6 & 26.0 & 15.7 & 55.5 & 43.4 & 64.5 & 52.9 & 69.7 & 54.5' 
SGCFNet50_18 = '95.5 & 83.6 & 90.2 & 70.8 & 78.9 & 61.9 & 69.7 & 36.7 & 48.7 & 33.9 & 30.3 & 13.0 & 60.4 & 46.4 & 62.1 & 49.2 & 70.4 & 54.8'
SGCFNet161_121 = '94.5 & 87.5 & 91.3 & 72.0 & 78.7 & 58.8 & 72.5 & 40.6 & 34.5 & 28.6 & 43.7 & 21.0 & 61.1 & 45.3 & 73.8 & 48.6 & 72.1 & 55.6'
# SGCFNet50_18 = '95.4789 & 83.6132 & 90.2704 & 70.8164 & 78.8798 & 61.8996 & 69.6703 & 36.6527 & 48.7217 & 33.9428 & 30.2799 & 13.0391 & 60.3676 & 46.3813 & 62.1150 & 49.2237 & 70.4451 & 54.7797'
# epoch: unlabeled, car, person, bike, curve, car_stop, guardrail, color_cone, bump, average(nan_to_num). (Acc=Recall %, IoU %)
# SGCFNet50_18[209]: (98.2224, 97.4489), (95.4789, 83.6132), (90.2704, 70.8164), (78.8798, 61.8996), (69.6703, 36.6527), (48.7217, 33.9428), (30.2799, 13.0391), (60.3676, 46.3813), (62.1150, 49.2237), (70.4451, 54.7797)
# SGCFNet161_121[256]: (98.4937, 97.6580), (94.5230, 87.4522), (91.2705, 72.0039), (78.6573, 58.7950), (72.5368, 40.5701), (34.4825, 28.6123), (43.7226, 21.0106), (61.1219, 45.2669), (73.8410, 48.6087), (72.0721, 55.5531)

EGFNet = '95.8 & 87.6 & 89.0 & 69.8 & 80.6 & 58.8 & 71.5 & 42.8 & 48.7 & 33.8 & 33.6 & 7.0 & 65.3 & 48.3 & 71.1 & 47.1 & 72.7 & 54.8'
MFFENet = '91.4 & 87.1 & 82.6 & 74.4 & 76.7 & 61.3 & 58.7 & 45.6 & 44.9 & 30.6 & 60.0 & 5.2 & 64.4 & 57.0 & 72.7 & 40.5 & 72.3 & 55.5'
MTANet = '95.8 & 88.1 & 90.9 & 71.5 & 80.3 & 60.7 & 75.3 & 40.9 & 62.8 & 38.9 & 38.7 & 13.7 & 63.8 & 45.9 & 70.8 & 47.2 & 75.2 & 56.1'

ABMDRNet = ' 94.3 & 84.8 & 90.0 & 69.6 & 75.7 & 60.3 & 64.0 & 45.1 & 44.1 & 33.1 & 31.0 & 5.1 & 61.7 & 47.4 & 66.2 & 50.0 & 69.5 & 54.8'

PSTNet = '89.4 & 77.0 & 74.8 & 67.2 & 65.8 & 50.8 & 42.5 & 35.2 & 34.6 & 25.2 & 0.0 & 0.0 & 32.7 & 29.9 & 61.1 & 55.0 & 55.5 & 48.6'

ResNet50_18 =  '93.4 & 83.5 & 91.8 & 72.7 & 83.7 & 61.9 & 75.1 & 40.7 & 39.7 & 31.7 & 59.1 & 11.2 & 59.1 & 50.9 & 60.5 & 45.5 & 73.2 & 55.1'		
DenseNet161_121= '94.6 & 86.3 & 89.7 & 72.9 & 88.2 & 61.7 & 60.3 & 43.7 & 27.2 & 30.8 & 56.7 & 6.5 & 68.4 & 52.4 & 81.3 & 47.3 & 73.8 & 55.5'
ResNet101_34 = '95.9 & 85.8 & 90.8 & 72.0 & 81.4 & 60.3 & 82.1 & 43.3 & 30.9 & 32.3 & 63.0 & 8.8 & 65.0 & 52.9 & 76.2 & 52.7 & 75.9 & 56.2'

def cal_unlabeled(str):
    term = str.split(' & ')
    interval_1 = 0
    interval_2 = 1
    acc = [] 
    iou = []
    sum_acc = 0
    sum_iou = 0
    for i in range(len(term)):
        if i % 2 ==0:
            acc.append(float(term[i]))
        else:
            iou.append(float(term[i]))
    print('acc: ', acc)
    print("iou: ", iou)
    for i in range(len(acc) - 1):
        sum_acc += acc[i]
        sum_iou += iou[i]
    unlabel_acc = acc[-1] * len(acc) - sum_acc
    unlabel_iou = iou[-1] * len(iou) - sum_iou
    print('unlabel_acc: {:.1f}, unlabel_iou: {:.1f}'.format(unlabel_acc, unlabel_iou))
    print('unlabel_acc, unlabel_iou: {:.1f} & {:.1f}'.format(unlabel_acc, unlabel_iou))

cal_unlabeled(ResNet101_34)






def merge_acc_iou(acc_str, iou_str):
    term_acc = acc_str.split(' & ')
    term_iou = iou_str.split(' & ')

    acc = [] 
    iou = []
    whole = []
    for i in range(len(term_acc)):
        # acc.append(float(term_acc[i]))
        # iou.append(float(term_iou[i]))
        whole.append(term_acc[i])
        whole.append(term_iou[i])
    whole_str = " & ".join(item for item in whole)
    print(whole_str)


## 161-121: /home/cjj/Documents/RTFNet/PolyWeightPath/DPAdd161_EGCFM_k5_addHead/121/poly/true/2aux/early_fusion_weight_c1.05/wd05_b4_lr0.001_e300_aw0.7/w_gate_w_skip_wo_early/20230108_212358/bs_4_lr_0.001_aux_0.7_test_results.txt
# Best mIoU in epoch 279 is 0.5552, and the mAcc is 0.6848
# Whole Acc: 30: 98.1 & 94.6 & 89.7 & 88.2 & 60.3 & 27.2 & 56.7 & 68.4 & 81.3 & 73.8
# Whole IoU: 279: 97.9 & 86.3 & 72.9 & 61.7 & 43.7 & 30.8 & 6.5 & 52.4 & 47.3 & 55.5
our_acc = '98.1 & 94.6 & 89.7 & 88.2 & 60.3 & 27.2 & 56.7 & 68.4 & 81.3 & 73.8'
our_iou = '97.9 & 86.3 & 72.9 & 61.7 & 43.7 & 30.8 & 6.5 & 52.4 & 47.3 & 55.5'


## 50-18: /home/cjj/Documents/RTFNet/PolyWeightPath/DPAdd50_EGCFM_k5_addHead/18/poly/true/2aux/early_fusion_weight_c1.05/wd05_b8_lr0.001_e300_aw0.7/w_gate_w_skip_wo_early/20230108_093953/bs_8_lr_0.001_aux_0.7_test_results.txt
# Best mIoU in epoch 254 is 0.5511, and the mAcc is 0.6800
# Whole Acc: 9: 96.4 & 93.4 & 91.8 & 83.7 & 75.1 & 39.7 & 59.1 & 59.1 & 60.5 & 73.2
# Whole IoU: 254: 97.7 & 83.5 & 72.7 & 61.9 & 40.7 & 31.7 & 11.2 & 50.9 & 45.5 & 55.1
our_acc = '96.4 & 93.4 & 91.8 & 83.7 & 75.1 & 39.7 & 59.1 & 59.1 & 60.5 & 73.2'
our_iou = '97.7 & 83.5 & 72.7 & 61.9 & 40.7 & 31.7 & 11.2 & 50.9 & 45.5 & 55.1'


## 101-34: /home/cjj/Documents/RTFNet/PolyWeightPath/DPAdd101_EGCFM_k5_addHead/34/poly/true/2aux/early_fusion_weight_c1.05/wd05_b4_lr0.001_e300_aw0.7/w_gate_w_skip_wo_early/20230107_093230/bs_4_lr_0.001_aux_0.7_test_results.txt
# Best mIoU in epoch 279 is 0.5622, and the mAcc is 0.7004
# Whole Acc: 30: 97.3 & 95.9 & 90.8 & 81.4 & 82.1 & 30.9 & 63.0 & 65.0 & 76.2 & 75.9
# Whole IoU: 279: 97.9 & 85.8 & 72.0 & 60.3 & 43.3 & 32.3 & 8.8 & 52.9 & 52.7 & 56.2
our_acc = '97.3 & 95.9 & 90.8 & 81.4 & 82.1 & 30.9 & 63.0 & 65.0 & 76.2 & 75.9'
our_iou = '97.9 & 85.8 & 72.0 & 60.3 & 43.3 & 32.3 & 8.8 & 52.9 & 52.7 & 56.2'

# merge_acc_iou(our_acc, our_iou)


# MFNet
# acc:  [77.2	67.0	53.9	36.2	12.5	0.1	30.3	30.0	45.1]
# iou:  [65.9	58.9	42.9	29.9	9.9	0.0	25.2	27.7	39.7]
# RTFNet
# acc:  [93.0	79.3	76.8	60.7	38.5	0.0	45.5	74.7	63.1]
# iou:  [87.4	70.3	62.7	45.3	29.8	0.0	29.1	55.7	53.2]
# PSTNet
# acc:  [89.4	74.8	65.8	42.5	34.6	0.0	32.7	61.1	55.5]
# iou:  [77.0	67.2	50.8	35.2	25.2	0.0	29.9	55.0	48.6]
# FuseSeg
# acc:  [93.1	81.4	78.5	68.4	29.1	63.7	55.8	66.4	70.6]
# iou:  [87.9	71.7	64.6	44.8	22.7	6.4	46.9	47.9	54.5]
# ABMDR
# acc:  [94.3	90.0	75.7	64.0	44.1	31.0	61.7	66.2	69.5]
# iou:  [84.8	69.6	60.3	45.1	33.1	5.1	47.4	50.0	54.8]
# MFFENet
# acc:  [91.4	82.6	76.7	58.7	44.9	60.0	64.4	72.7	72.3]
# iou:  [87.1	74.4	61.3	45.6	30.6	5.2	57.0	40.5	55.5]
# EGFNet
# acc:  [95.8	89.0	80.6	71.5	48.7	33.6	65.3	71.1	72.7]
# iou:  [87.6	69.8	58.8	42.8	33.8	7.0	48.3	47.1	54.8]
# MTANet
# acc:  [95.8	90.9	80.3	75.3	62.8	38.7	63.8	70.8	75.2]
# iou:  [88.1	71.5	60.7	40.9	38.9	13.7	45.9	47.2	56.1]
